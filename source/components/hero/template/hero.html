{% from 'video.html' import video  %}
{% from 'button.html' import button %}
{% from 'modal.html' import modal %}
{% import 'form-elements.html' as form %}


<div class="c-hero">
    {{ video({
      instance_id: 1,
      id: '1',
      platform: 'native',
      title: 'Dept agency Introduction',
      description: 'Introduction Video',
      thumbnail: 'https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-1280x720-c.jpg',
      controls: 0,
      playsinline: 1,
      autoplay: 1,
      loop: 1,
      muted: 1,
      image: {
          preload: 'https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-480x250-c.jpg',
          image: 'https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-1280x720-c.jpg',
          srcset: 'https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-320x250-c.jpg 320w,https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-480x250-c.jpg 480w,https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-730x410-c.jpg 1024w,https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-1024x576-c.jpg 1024w,https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-1280x720-c.jpg 1280w,https://www.deptagency.com/wp-content/uploads/fly-images/114213/Dept_Berlin_Office-19-1440x810-c.jpg 1440w'
      },
      sources: [
          {
              size : 1920,
              source: [
                  {
                      url: 'https://player.vimeo.com/external/344108443.hd.mp4?s=c1730857e5c3097471ce4d0e05b3bfd287ab561f&profile_id=175',
                      type: 'video/mp4'
                  }
              ]
          },
          {
              size : 1280,
              source: [
                  {
                      url: 'https://player.vimeo.com/external/344108443.hd.mp4?s=c1730857e5c3097471ce4d0e05b3bfd287ab561f&profile_id=175',
                      type: 'video/mp4'
                  }
              ]
          },
          {
              size : 1024,
              source: [
                  {
                      url: 'https://player.vimeo.com/external/344108443.hd.mp4?s=c1730857e5c3097471ce4d0e05b3bfd287ab561f&profile_id=175',
                      type: 'video/mp4'
                  }
              ]
          },
          {
              size : 960,
              source: [
                  {
                      url: 'https://player.vimeo.com/external/344108443.sd.mp4?s=c1730857e5c3097471ce4d0e05b3bfd287ab561f&profile_id=175',
                      type: 'video/mp4'
                  }
              ]
          },
          {
              size : 640,
              source: [
                  {
                      url: 'https://player.vimeo.com/external/344108443.hd.mp4?s=c1730857e5c3097471ce4d0e05b3bfd287ab561f&profile_id=175',
                      type: 'video/mp4'
                  }
              ]
          }
      ]
  }) }}

    <div class="o-container">
        {% call modal({
            id:'modal-subsc'
        }, js-hook-modal) %}
        <h3>Niks willen missen van onze nieuwtjes en acties?</h3>
        {%call form.form() %}

        {{ form.input({
                type: 'email',
                class: 'input__email',
                name:'input-email',
                id: 'email',
                placeholder: 'Emailaddress'
            })}}

       <div class="name-input-container">
            {{ form.input({
                    name:'input-first',
                    class: 'input__first hidden',
                    id: 'first',
                    placeholder: 'First name'
                })}}
    
            {{ form.input({
                    name:'input-last',
                    class: 'input__last hidden',
                    id: 'last',
                    placeholder: 'Last name'
                })}}
       </div>

        {% endcall %}
        <!-- /form -->

        {{ button( {
                class: 'modal__button-back hidden',
                icon: 'chevron-left',
                label: 'back',
                variant: 'ghost'
            } ) }}

        {{ button( {
                class: 'modal__button-submit hidden',
                label: 'submit',
                variant: 'primary',
                icon: 'chevron-right'
            } ) }}

        </form>

        {% endcall %}

        <div class="hero__content">

            <h1 class="hero__title u-margin-bottom--sm">We are going to create: <br />A modal with a newsletter form!!
            </h1>
            <p class="hero__subtitle">Let's get started!</p>
        </div>

        {{ button( {
      class: 'hero__cta',
      label: 'Subscribe to newsletter',
      url: '#',
      variant: 'secondary',
      icon: 'chevron-right',
      hook: 'modal__button-close',
      controls: 'modal-subsc'
    } ) }}
    </div>
</div>

<script>
    const modal = document.querySelector('#modal-subsc')
    const openButton = document.querySelector('.hero__cta')
    const videoDiv = document.querySelector('.video__player')
    const closeButton = document.querySelector('.modal__button-close')
    const emailInput = document.querySelector('#email')

    //open modal with button 'open modal'
    openButton.addEventListener('click', openModal)
    function openModal() {
        console.log('I am clicked')
        modal.classList.toggle('modal--is-showing')
        modal.classList.add('modal-subsc')

        //pause the video
        videoDiv.firstChild.pause()

        //show the close button
        closeButton.style.visibility = 'visible'

        //style the close button
        closeButton.classList.add('modal__button-round')

        //hide the subscribe button
        openButton.classList.add('hidden')
    }

    //close modal with x button
    closeButton.addEventListener('click', closeModal)
    closeButton.addEventListener('keyPress', closeModal)
    function closeModal() {
        console.log('Closing the modal')
        modal.classList.toggle('modal--is-showing')

        //resume the video
        videoDiv.firstChild.play()

        //show the subscribe button
        openButton.classList.remove('hidden')
    }

    emailInput.addEventListener('click', showHiddenForm)
    function showHiddenForm() {
        console.log('email clicked!')
        document.querySelector('.input__first').classList.remove('hidden')
        document.querySelector('.input__last').classList.remove('hidden')
        document.querySelector('.modal__button-back').classList.remove('hidden')
        document.querySelector('.modal__button-submit').classList.remove('hidden')
    }

</script>